{ 
    "Schema": "rakan-device",
    "description": "Stores current state & desired state of iot devices(nano esp32)",
    "Tables":[
        {
            "TableName": "rakan-devicestate",
            "KeySchema": [
                {
                    "AttributeName": "deviceId",
                    "KeyType": "HASH"
                }
            ],

            "AttributeDefinitions": [
                {
                    "AttributeName": "deviceId",
                    "AttributeType": "S"
                }
            ],

            "BillingMode": "PAY_PER_REQUEST",
            "TimeToLiveSpecification": {
                "Enabled": true,
                "AttributeName": "ttl"
            },

            "ItemExample":{
                "deviceId": "thermo-001",
                "currentState": {
                    "temperatureF": "<float from device>",
                    "humidity": "<float from device>",
                    "occupancy": "<boolean from device>",
                    "timestamp": "<auto-generated ETC timestamp>"
                },

                "desiredState": {
                    "temperatureF": "<User defined>",
                    "mode": "<cool/heat/auto/off>",
                    "fan": "<on/off/auto>"
                },

                "status": "online",
                "lastUpdated": 1699999999,
                "ttl": 1700000000,
                "//comment" : "ttl sets data expiration date(in seconds)"
            },

            "AccessPatterns":[
                "GetItem(deviceID='esp32')->decison lambda",
                "PutItem(Item=device_state) -> ingestLambda",
                "UpdateItem(deviceID='esp32', desiredState=new_state) -> controlLambda"
            ]
        },
        {
            "TableName": "rakan-devicehistory",
            "KeySchema": [
                { "AttributeName": "deviceId", "KeyType": "HASH" },
                { "AttributeName": "timestamp", "KeyType": "RANGE" }
            ],
            "AttributeDefinitions": [
                { "AttributeName": "deviceId", "AttributeType": "S" },
                { "AttributeName": "timestamp", "AttributeType": "S" }
            ],
            "BillingMode": "PAY_PER_REQUEST",
            "TimeToLiveSpecification": {
                "Enabled": true,
                "AttributeName": "ttl"
            },
            "ItemExample": {
                "deviceId": "esp32-001",
                "timestamp": "2025-10-31T19:00:00Z",
                "temperatureF": 74.5,
                "humidity": 46.1,
                "occupancy": true,
                "ttl": 1735699500
            },
            "AccessPatterns": [
                "Query(deviceId='esp32-001', timestamp BETWEEN start AND end) â†’ analytics"
            ]
        }
    ]
}